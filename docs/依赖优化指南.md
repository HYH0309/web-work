# 📦 Vue项目依赖优化指南

## 🎯 优化目标

- **减少包体积**：移除重复和未使用的依赖
- **提升性能**：优化构建速度和运行时性能
- **简化维护**：统一功能类似的库选择
- **解决冲突**：避免不同库间的兼容性问题

## 📊 优化前后对比

### 优化前

- **总依赖数**：83个
- **生产依赖**：60个
- **开发依赖**：23个
- **预估打包体积**：~8MB

### 优化后

- **总依赖数**：65个 ⬇️ 22%
- **生产依赖**：32个 ⬇️ 47%
- **开发依赖**：33个 ⬆️ 43%
- **预估打包体积**：~5MB ⬇️ 37%

## 🔧 具体优化措施

### 1. 移除重复依赖

#### Markdown处理器统一

```bash
# 移除 marked 相关包（保留 markdown-it）
npm uninstall marked marked-alert marked-base-url marked-code-format marked-code-preview marked-extended-tables marked-highlight
```

**原因**：项目主要使用 `markdown-it`，`marked` 系列包未被充分利用

#### 代码高亮统一

```bash
# 移除多余的高亮库（保留 prismjs + markdown-it-highlightjs）
npm uninstall highlight.js highlight
```

**原因**：`prismjs` 与 `markdown-it-highlightjs` 配合更好

#### 图标库优化

```bash
# 移除冗余图标库（保留 @heroicons/vue）
npm uninstall @iconify/vue lucide-vue-next
```

**原因**：`@heroicons/vue` 已能满足项目需求，减少包体积

#### 动画库整合

```bash
# 移除多余动画库（保留 motion-v）
npm uninstall @vueuse/motion gsap
```

**原因**：`motion-v` 功能足够，避免库冲突

#### 编辑器选择

```bash
# 移除 Monaco Editor（保留 CodeMirror）
npm uninstall monaco-editor monaco-editor-vue3 vite-plugin-monaco-editor
```

**原因**：项目主要使用 CodeMirror，Monaco Editor 体积较大

### 2. 移除未使用依赖

```bash
# 移除明确未使用的包
npm uninstall anchor i css-tree tsparticles-engine typeit
npm uninstall @tsparticles/slim @tsparticles/vue3
npm uninstall @mdit/plugin-mathjax markdown-it-diagram markdown-it-expandable markdown-it-mathjax3 markdown-it-prism
npm uninstall @types/highlight.js @types/jszip
npm uninstall unplugin-starter
```

### 3. 版本统一优化

```bash
# 统一 UnoCSS 版本
npm install @unocss/preset-wind4@66.1.1 @unocss/transformer-directives@66.1.1
```

## 📝 代码迁移指南

### 1. 图标库迁移

如果代码中使用了 `@iconify/vue` 或 `lucide-vue-next`：

```vue
<!-- 迁移前 -->
<Icon icon="lucide:settings" />
<Settings />

<!-- 迁移后 -->
<CogIcon class="w-5 h-5" />
```

### 2. 动画库迁移

如果使用了 `@vueuse/motion`：

```vue
<!-- 迁移前 -->
<div v-motion="motionConfig">

<!-- 迁移后 -->
<motion.div :animate="motionConfig">
```

### 3. 编辑器迁移

如果使用了 Monaco Editor：

```vue
<!-- 迁移前 -->
<MonacoEditor v-model="code" language="typescript" />

<!-- 迁移后 -->
<Codemirror v-model="code" :options="{ mode: 'javascript' }" />
```

## 🚀 实施步骤

### 第一阶段：安全移除（低风险）

```bash
# 移除明确未使用的依赖
npm uninstall anchor i css-tree unplugin-starter typeit
npm uninstall @types/highlight.js @types/jszip
```

### 第二阶段：功能合并（中风险）

```bash
# 统一 Markdown 处理
npm uninstall marked marked-alert marked-base-url marked-code-format marked-code-preview marked-extended-tables marked-highlight

# 统一代码高亮
npm uninstall highlight.js highlight
```

### 第三阶段：组件替换（高风险）

```bash
# 需要代码修改的依赖移除
npm uninstall @iconify/vue lucide-vue-next
npm uninstall @vueuse/motion gsap
npm uninstall monaco-editor monaco-editor-vue3 vite-plugin-monaco-editor
```

## ⚠️ 注意事项

1. **备份代码**：执行优化前确保代码已备份
2. **分步执行**：按阶段执行，每次验证功能正常
3. **测试覆盖**：每次移除后运行完整测试套件
4. **构建验证**：确保生产构建仍然正常

## 📈 预期收益

- **构建速度提升**：30-40%
- **开发服务器启动**：更快的冷启动
- **包体积减少**：生产包体积减少约37%
- **维护成本降低**：更少的依赖更新维护
- **潜在冲突减少**：避免库间版本冲突

## 🔍 验证命令

```bash
# 检查未使用依赖
npx depcheck

# 分析包体积
npx vite-bundle-analyzer

# 检查重复包
npm ls --depth=0 | grep -E "(duplicate|conflicts)"
```

## 📋 迁移检查清单

- [ ] 移除第一阶段依赖
- [ ] 运行 `npm run build` 验证
- [ ] 运行 `npm run test:unit` 验证
- [ ] 移除第二阶段依赖
- [ ] 更新相关代码（如有）
- [ ] 运行完整测试套件
- [ ] 移除第三阶段依赖
- [ ] 更新组件引用
- [ ] 最终功能验证
- [ ] 性能基准测试
